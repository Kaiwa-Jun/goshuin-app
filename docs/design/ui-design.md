# UI設計 v6

**バージョン**: v6

## 1. アプリ概要

### コンセプト

「集めるたび、地図があなたの旅になる。」

### ターゲットユーザー

- 御朱印集めを始めたばかりの人
- 記録を残したいが、既存アプリが複雑で挫折した人
- 旅の記録として御朱印を地図で振り返りたい人

### コアバリュー

1. **シンプルさ**: 3タップで記録完了
2. **地図体験**: 訪問履歴が地図に蓄積される達成感
3. **ゲーミフィケーション**: バッジ・チャレンジでモチベーション維持

## 2. 画面一覧（全16画面）

### MVP画面（13画面）

| # | 画面名 | 説明 | ログイン |
|---|---|---|---|
| 1 | オンボーディング | 4スライドのアプリ紹介 | 不要 |
| 2 | ログイン | Googleログイン | - |
| 3 | 地図画面 | メイン画面、スポット表示 | 任意 |
| 4 | スポット詳細 | 神社仏閣の情報 | 任意 |
| 5 | 御朱印記録 | 写真撮影・スポット選択 | 必須 |
| 6 | 登録完了（バッジあり） | 成功演出＋バッジ獲得 | 必須 |
| 7 | 登録完了（バッジなし） | シンプルな成功演出 | 必須 |
| 8 | ギャラリー | 御朱印一覧（グリッド表示） | 必須 |
| 9 | 御朱印詳細 | 個別の御朱印表示 | 必須 |
| 10 | コレクション | 統計・バッジ・チャレンジ | 必須 |
| 11 | 設定 | アカウント・プラン管理 | 任意 |
| 12-14 | エラー画面×3 | ネットワーク/位置情報/アップロード | - |

### 将来画面（2画面）

| # | 画面名 | 説明 |
|---|---|---|
| 15 | 御朱印帳一覧 | 御朱印帳の管理 |
| 16 | 御朱印帳詳細 | 御朱印帳の中身表示 |

## 3. 画面遷移フロー

### 初回起動フロー

```
[アプリ起動]
    ↓
[オンボーディング（4画面）]
    ├─ スキップ → [地図画面（未ログイン）]
    └─ 完了 → [位置情報許可ダイアログ]
                  ↓
              [地図画面（未ログイン）]
```

### 御朱印記録フロー

```
[地図画面]
    ↓ +ボタン
[ログイン確認]（未ログイン時のみ）
    ↓ ログイン
[御朱印記録画面]
    ↓ 保存
[確認ダイアログ]
    ↓ 登録する
[登録完了演出]
    ├─ もう1枚記録 → [御朱印記録画面]
    ├─ 地図を見る → [地図画面]
    └─ コレクションを確認 → [コレクション画面]
```

### タブナビゲーション

```
[地図] ← → [ギャラリー] ← → [コレクション] ← → [設定]
```

※御朱印帳タブはMVP時は非表示

## 4. 画面詳細仕様

### 4.1 オンボーディング画面

**目的**: アプリの価値を伝え、位置情報許可を促す

**スライド構成（4画面）**:

| # | アイコン | 背景色 | タイトル | 説明 |
|---|---|---|---|---|
| 1 | 地図 | オレンジ | 御朱印を地図で管理 | 訪れた神社やお寺が地図上にマッピングされます |
| 2 | カメラ | 紫 | かんたん記録 | 写真を撮るだけですぐに御朱印を記録できます |
| 3 | トロフィー | 黄色 | コレクションを楽しむ | 巡礼チャレンジやバッジで御朱印集めがもっと楽しく |
| 4 | ピン | 緑 | 近くのスポットを発見 | 位置情報をオンにすると周辺の神社仏閣が見つかります |

**UI要素**:

- 右上: 「スキップ」テキストボタン（グレー）
- 中央: アイコン（24×24、角丸3xl、シャドウ付き）
- 下部: ページインジケーター（ドット、現在ページはオレンジで幅広）
- ボタン: 1-3画面は「次へ」、4画面は「位置情報を許可して始める」＋「あとで設定する」

**技術メモ**:

- スライド切り替えはスワイプ対応
- 完了後、LocalStorageにonboarding_completedフラグを保存

### 4.2 ログイン画面

**目的**: ユーザー認証（遅延ログイン方式）

**UI要素**:

- 背景: グラデーション（orange-50 → white）
- アイコン: 24×24、グラデーション（orange-400 → orange-600）
- Googleボタン: 白背景、グレーボーダー、Googleロゴ付き
- 「後で」: グレーのテキストリンク
- 利用規約: オレンジのテキストリンク

**技術メモ**:

- Supabase Auth with Google OAuth
- ログイン成功後、直前の画面（記録画面など）に遷移

### 4.3 地図画面（メイン）

**目的**: スポット発見・訪問履歴の可視化

**検索バー仕様**:

- タップでサジェスト表示
- 未入力時: 現在地周辺3件を表示
- 入力時: スポット名でフィルタリング
- 候補タップでスポット詳細へ遷移

**フィルターボタン仕様**:

- ログイン時のみ表示
- タップでドロップダウン: 「すべて表示」「訪問済みのみ」
- 選択中はオレンジのリング表示
- 未ログイン時は「すべて表示」固定（ボタン非表示）

**ピン表示ルール**:

| 状態 | 色 | サイズ |
|---|---|---|
| 訪問済み（神社） | 赤 (red-500) | 16px |
| 訪問済み（寺院） | 紫 (purple-500) | 16px |
| 未訪問 | グレー (gray-400) | 12px |
| 現在地 | 青 (blue-500) | 20px + パルスアニメーション |

**FABボタン（+）**:

- 位置: 画面下部中央
- サイズ: 64×64
- 色: オレンジ (orange-500)
- タップ: 未ログイン時はログイン促進モーダル表示

### 4.4 スポット詳細画面

**目的**: 神社仏閣の情報表示・記録への誘導

**バッジ色**:

- 神社: 赤背景 (red-100) + 赤文字 (red-600)
- 寺院: 紫背景 (purple-100) + 紫文字 (purple-600)
- 訪問済み: オレンジ背景 (orange-100) + オレンジ文字 (orange-600)

**表示要素**:

- 種別バッジ + 訪問済みバッジ
- スポット名
- 住所
- 訪問回数・最終訪問日
- 「ここで記録する」CTAボタン
- 記録済み御朱印のグリッド表示
- ミニマップ

### 4.5 御朱印記録画面

**目的**: 御朱印の写真とスポットを記録

**入力項目**:

- スポット（必須）: 最寄りのスポットが自動選択、ドロップダウンで変更可
- 御朱印の写真（必須）: カメラ撮影 or ギャラリーから選択
- 訪問日: デフォルトは今日
- メモ（任意）

**スポット選択ドロップダウン**:

- 検索バー付き
- 現在地周辺2km以内を距離順で表示
- 「スポットが見つからない場合は追加」リンク
- 選択済みスポットはオレンジ背景

### 4.6 登録完了画面

**目的**: 達成感の演出・次のアクションへ誘導

**背景**: グラデーション（orange-400 → orange-500）

**表示要素**:

- 御朱印画像
- 訪問箇所数（「33箇所目！」等）
- バッジ獲得時: バッジ名と説明を表示

**ボタン仕様**:

- 「もう1枚記録」: 白20%背景、白文字
- 「地図を見る」: 白背景、オレンジ文字
- 「コレクションを確認」: 白80%透明テキスト

### 4.7 ギャラリー画面

**目的**: 記録した御朱印の一覧表示

**ソート機能**:

- 日付順（デフォルト）: 新しい順
- スポット順: あいうえお順
- ドロップダウンメニューで切り替え

**グリッド表示**:

- 3列
- 画像は正方形（aspect-square）
- 画像下にスポット名（truncate）
- 日付順の場合は日付も表示

**無料版制限**: 直近20件のみ表示、プレミアムへの誘導バナー

### 4.8 コレクション画面

**目的**: 達成状況の可視化・モチベーション維持

**表示セクション**:

1. **達成サマリー**: 総訪問箇所数、総御朱印数
2. **地域別**: 県別の訪問数をプログレスバーで表示
3. **巡礼チャレンジ**: チャレンジ名、進捗（例: 12/33）、達成率
4. **獲得バッジ**: 獲得済みは黄色、未獲得はグレー

### 4.9 設定画面

**セクション**:

- **アカウント**: ユーザー名、メール、ログアウト
- **プラン**: 現在のプラン表示、プレミアムへのアップグレード誘導
- **アプリ情報**: バージョン、利用規約、プライバシーポリシー

### 4.10 エラー画面（3種類）

1. **ネットワークエラー**: 再試行ボタン
2. **位置情報エラー**: 設定方法の案内 + 設定を開くボタン + 「後で設定する」リンク
3. **アップロードエラー**: 再試行ボタン + キャンセルリンク

## 5. モーダル仕様

| モーダル | 表示位置 | 内容 |
|---|---|---|
| 写真追加 | 下からスライドイン | カメラで撮影 / ギャラリーから選択 / キャンセル |
| スポット追加 | 中央表示 | スポット名（必須）、種別（神社/寺院）|
| 登録確認 | 中央表示 | スポット名、種別、訪問日、戻る/登録するボタン |
| ログイン促進 | 中央表示 | カメラアイコン、「ログインが必要です」、Googleログイン/後で |

## 6. デザイン方針

### 全体的なトーン

- **オレンジを基調**としたカラーパレット（メインアクセント）
- 神社は赤系、寺院は紫系で色分け
- モバイルファースト設計

### 重要なUXポイント

1. **遅延ログイン方式**: 未ログインでも地図閲覧可能、記録時にログイン促進
2. **未ログイン時はフィルターボタン非表示**: 検索バーのみ表示
3. **シンプルなタブナビゲーション**: 地図・ギャラリー・コレクション・設定の4タブ
4. **ゲーミフィケーション要素**: バッジ獲得演出、巡礼チャレンジ進捗
5. **エラー画面3種類**: ネットワーク、位置情報、アップロード

※ 詳細なカラーパレット、タイポグラフィ、コンポーネントスタイルはStitchに任せる

## 7. Rive活用計画（モーション設計）

MVP後のフェーズで、主要なUI要素を**Rive**のインタラクティブアニメーションに置き換える。

### Rive化対象箇所（優先度順）

| 優先度 | 対象要素 | 画面 | 想定する演出 |
|---|---|---|---|
| 高 | チェックマーク + 紙吹雪演出 | 登録完了画面 | チェックが弾む → 紙吹雪 → バッジ出現 |
| 高 | バッジ獲得アニメーション | 登録完了 / コレクション | 未獲得(locked) → 獲得(unlocked) の状態遷移 |
| 中 | FABボタン（+） | 地図画面 | タップで沈む → 弾む、待機中は微小パルス |
| 中 | オンボーディングアイコン | オンボーディング | 各スライドのアイコンが動くイラストに |
| 低 | ローディング / プログレス | 御朱印アップロード中 | 御朱印風のローディングアニメーション |
| 低 | エラーアイコン | エラー画面3種 | 揺れるWifi、困った顔のピンなど |

### 導入ステップ

1. **MVP段階**: ベースUIを構築（CSS/Framer Motionで最低限のアニメーション）
2. **Rive Communityで素材探し**: チェックマーク、ローディング等の汎用素材を探す
3. **登録完了画面からRive化**: 最も効果が大きい箇所から開始
4. **他の画面に展開**: 効果を検証しながら広げる

### Riveコンポーネント切り出し対象

以下の要素は独立したコンポーネントとして切り出しておくこと（後からRiveコンポーネントに差し替えやすくするため）:

- 登録完了画面のチェックマーク / 演出エリア
- バッジ表示コンポーネント
- FABボタン（+）
- オンボーディングの各スライドアイコン
- エラー画面のアイコン
